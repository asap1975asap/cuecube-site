<%- include('layout', { user: user, body: '' }) %>

<div class="product-detail">
  <div>
    <img src="<%= product.images[0] %>" alt="<%= product.name %>" class="main-image" id="mainProductImage">
    <div class="thumbnail-container" id="thumbs">
      <% product.images.forEach(function(img, index) { %>
        <img src="<%= img %>" data-img="<%= img %>" class="<%= index === 0 ? 'active' : '' %>">
      <% }) %>
    </div>
  </div>

  <div class="info">
    <h2><%= product.name %></h2>
    <p>by <%= product.brand %></p>

    <% /* Show profile selector only for the first CueCube product */ %>
    <% if (product.id === 0) { %>
      <div style="margin: 18px 0;">
        <label for="profileSelect"><strong>Tip profile:</strong></label>
        <select id="profileSelect" class="quantity-input" style="width:auto; margin-left:10px;">
          <option value=".418" selected>.418 in (Nickel)</option>
          <option value=".353">.353 in (Dime)</option>
        </select>
      </div>
    <% } %>

    <h4>Wholesale pricing:</h4>
    <p>10+ pcs: <strong>$<%= product.price10 %></strong> per unit</p>
    <p>50+ pcs: <strong>$<%= product.price50 %></strong> per unit</p>
    <p>100+ pcs: <strong>$<%= product.price100 %></strong> per unit</p>

    <label for="qtyInput"><strong>Quantity (min 10 pcs):</strong></label>
    <input id="qtyInput" class="quantity-input" type="number" min="10" step="1" value="<%= defaultQty %>">

    <p id="unitPriceText">Unit price: $<%= unitPrice.toFixed(2) %></p>
    <p id="totalPriceText">Total: $<%= total %></p>

    <a class="order-btn" id="placeOrderBtn" href="/order?productId=<%= product.id %>&qty=<%= defaultQty %>">Place order</a>
  </div>
</div>

<div style="max-width: 900px; margin: 40px auto;">
  <h3>Product details</h3>
  <pre style="white-space: pre-wrap;"><%= product.longDesc %></pre>
</div>

<script src="/main.js"></script>
<script>
  // Basic product data used for price calculation
  window.cuecubeProduct = {
    id: <%= product.id %>,
    price10: <%= product.price10 %>,
    price50: <%= product.price50 %>,
    price100: <%= product.price100 %>
  };

  // Image sets for CueCube Grey variants (.418 and .353)
  <% if (product.id === 0) { %>
  window.cuecubeVariants = {
    ".418": [
      "/images/cue-cube-grey-418-1.jpg",
      "/images/cue-cube-grey-418-2.jpg",
      "/images/cue-cube-grey-418-3.jpg"
    ],
    ".353": [
      "/images/cue-cube-grey-353-1.jpg",
      "/images/cue-cube-grey-353-2.jpg",
      "/images/cue-cube-grey-353-3.jpg"
    ]
  };
  <% } %>
</script>
