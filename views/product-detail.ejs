<% layout('layout') %>
<div class="product-detail-wrap">
    <div class="product-gallery">
        <img id="mainImage" src="<%= product.variants.find(v => v.code === selectedCode).images[0] %>" class="main-image" alt="<%= product.name %>" />
        <div class="thumb-row">
            <% product.variants.find(v => v.code === selectedCode).images.forEach(function(img, idx){ %>
                <img src="<%= img %>" data-full="<%= img %>" class="thumb <% if(idx === 0){ %>active-thumb<% } %>" />
            <% }) %>
        </div>
    </div>
    <div class="product-info">
        <h1><%= product.name %></h1>
        <p class="byline">by <%= product.brand %></p>

        <label class="inline-label">Tip profile:
            <select id="diameterSelect">
                <% product.variants.forEach(function(v){ %>
                    <option value="<%= v.code %>"><%= v.label %></option>
                <% }) %>
            </select>
        </label>

        <h3>Wholesale pricing:</h3>
        <ul class="price-list">
            <li>10+ pcs: $<%= product.basePrice.toFixed(2) %> per unit</li>
            <li>50+ pcs: $<%= (product.basePrice * 0.85).toFixed(2) %> per unit</li>
            <li>100+ pcs: $<%= (product.basePrice * 0.72).toFixed(2) %> per unit</li>
        </ul>

        <label class="inline-label">Quantity (min 10 pcs):
            <input id="qtyInput" type="number" min="10" value="10" />
        </label>

        <p id="unitPriceLine">Unit price: $<%= product.basePrice.toFixed(2) %></p>
        <p id="totalPriceLine">Total: $<%= (product.basePrice * 10).toFixed(2) %></p>

        <a id="orderButton" class="btn" href="/order?productId=<%= product.id %>&qty=10&diameter=<%= selectedCode %>">Place order</a>
    </div>
</div>

<div class="product-details-text">
    <h2>Product details</h2>
    <h3>Product features:</h3>
    <ul>
        <% product.details.features.forEach(function(f){ %>
            <li><%= f %></li>
        <% }) %>
    </ul>
    <h3>Product specifications:</h3>
    <ul>
        <% product.details.specs.forEach(function(s){ %>
            <li><%= s %></li>
        <% }) %>
    </ul>
</div>
